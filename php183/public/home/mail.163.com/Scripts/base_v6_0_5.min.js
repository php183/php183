function fCheckLoginNow(){if(!fGetCookie("cm_last_info"))return document.documentElement.style.display="block",void 0;if(document.documentElement.style.display="none",!$id("loginjustnowiframe")){var a=document.createElement("iframe");a.id="loginjustnowiframe",a.style.display="none",a.src=gOption["url"]+fUrlP("df","loginjustnow"+gOption["product"],!0)+fUrlP("funcid","loginjustnow")+fUrlP("iframe","1");try{document.body.appendChild(a),setTimeout(function(){document.documentElement.style.display="block"},500)}catch(b){setTimeout(function(){fCheckLoginNow()},80)}}}function fCheckAutoLogin(){try{-1!=window.location.href.indexOf("#return")&&("163.com"==gOption["sDomain"]?fSetCookie("P_INFO","",!1,gOption["sDomain"]):fSetCookie("P_INFO",""))}catch(a){}}function fAutoLogin(){var b,c,d,e,f,g;try{fGetCookie("S_INFO"),b=fGetCookie("P_INFO"),c="",d="",e="",f=0,b&&(g=b.split("|"),c=g[0],d=g[1],e=g[2],f=(new Date).getTime()-(d+"000")),!location.hash&&c.indexOf("@"+gOption["sDomain"])>-1&&"1"==e&&864e6>f&&(window.location.href=gUserInfo&&gUserInfo.style?gOption["sAutoLoginUrl"]+"&style="+gUserInfo.style:gOption["sAutoLoginUrl"])}catch(h){}("yeah.net"==gOption["sDomain"]||"126.com"==gOption["sDomain"]||"163.com"==gOption["sDomain"])&&fCheckLoginNow()}function fCheckBrowser(){var a,b,c,d,e;if(gbForcepc="pc"==fGetQuery("dv"),!gbForcepc)for(a=navigator.userAgent.toLowerCase(),c={ipad:"http://ipad.mail."+gOption["sDomain"]+"/?dv=ipad",pad:"http://pad.mail."+gOption["sDomain"]+"/",smart:"http://smart.mail."+gOption["sDomain"]+"/?dv=smart",m:"http://m.mail."+gOption["sDomain"]+"/"},d=["ipad","iphone os","android","ucweb","rv:1.2.3.4","windows ce","windows mobile","midp"],e=0;e<d.length;e++)if(-1!=a.indexOf(d[e])){switch(d[e]){case"ipad":b=c["ipad"];break;case"iphone os":b=c["smart"];break;case"pad":b=c["pad"];break;case"android":return c["smart"]||(c["smart"]="http://email.163.com/?dv=pc"),c["pad"]||(c["pad"]="http://email.163.com/?dv=pc"),oAndroidRedirect={sPhoneUrl:c["smart"],sPadUrl:c["pad"]},top.location.href="http://mail.163.com/html/android_device/v1.htm?smart="+encodeURIComponent(oAndroidRedirect.sPhoneUrl)+"&pad="+encodeURIComponent(oAndroidRedirect.sPadUrl),!1;default:b=c["m"]}window.location.href=b}}function fHtml5Tag(){var a=["aside","figcaption","figure","footer","header","hgroup","nav","section"],b=0;for(b in a)document.createElement(a[b])}function fCheckCookie(){navigator.cookieEnabled||alert("您好，您的浏览器设置禁止使用cookie\n请设置您的浏览器，启用cookie功能，再重新登录。")}function fGetQuery(a,b){var c=window.location.search.substr(1),d=c.match(new RegExp("(^|&)"+a+"=([^&]*)(&|$)"));return b?null==d?null:d[2]:null==d?null:unescape(d[2])}function fGetQueryHash(a){var b=window.location.hash.substr(1),c=b.match(new RegExp("(^|&)"+a+"=([^&]*)(&|$)"));return null==c?null:unescape(c[2])}function $id(a){return document.getElementById(a)}function fTrim(a){return a.replace(/(^\s*)|(\s*$)/g,"").replace(/(^　*)|(　*$)/g,"")}function fParseMNum(a){var b=fTrim(a);return/^0?(13|14|15|18)\d{9}$/.test(b)}function fCheckAccount(a){var e,b=a,c=b.toLowerCase(),d=-1==c.indexOf("@"+gOption["sDomain"]);return d||(e=a.split("@"),a=e[0]),a}function fGetScript(a,b,c){var d=document.createElement("script");d.setAttribute("type","text/javascript"),d.setAttribute("src",a);try{d.setAttribute("defer","defer")}catch(e){}window.document.body.appendChild(d),void 0!==d.onreadystatechange?d.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||b&&b()}:d.onload=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||b&&b()},d.onerror=function(){c&&c()}}function fGetCookie(a){var c,b=a+"=";return document.cookie.length>0?(offset=document.cookie.indexOf(b),-1!=offset?(offset+=b.length,end=document.cookie.indexOf(";",offset),-1==end&&(end=document.cookie.length),c=unescape(document.cookie.substring(offset,end)),"string"==typeof c&&c.constructor==String&&(c=c.replace(/[\<\>\'\"\;]/g,"")),c):""):void 0}function fSetCookie(a,b,c,d){"string"==typeof b&&b.constructor==String&&(b=b.replace(/[\<\>\'\"\;]/g,""));var e=";domain="+(d||gOption["sCookieDomain"]);document.cookie=a+"="+escape(b)+e+(c?";expires="+new Date(2099,12,31).toGMTString():"")}function fEventListen(a,b,c,d){d=!!d,a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)}function fEventUnlisten(a,b,c,d){d=!!d,a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)}function fRandom(a){return Math.floor(a*Math.random())}function fUrlP(a,b,c){return arguments[2]||(c=!1),c?a+"="+b:"&"+a+"="+b}function fResize(){var c,a=document.body.offsetHeight,b=document.documentElement.clientHeight;c=a>b?a:b,$id("mask").style.height=c+"px"}function fJSONP(a,b){var d,e,f;if(a){d="&";for(e in b)d+=e+"="+b[e]+"&";f=d.split("&"),f.pop(),f.shift(),d=f.join("&"),fGetScript(a+"?"+d+"&rnd="+Math.random())}}function fFQ(){var e,f,g,a=fGetQuery("fq"),b=/^[0-9]/.test(a),c=fGetQuery("uid"),d=new RegExp("(@"+gOption["sDomain"]+")$").test(c);b&&d&&(e=(new Date).getTime(),fSetCookie("fq",a+"_"+e,!1),f=document.createElement("img"),g="http://count.mail.163.com/beacon/login.gif?uid="+c+"&fq="+e+"&lf="+fGetQuery("fq"),f.setAttribute("src",g),f.setAttribute("alt",""),f.style.display="none",document.body.appendChild(f))}function fStartTime(){var a=fGetCookie("starttime");""==a&&(a=(new Date).getTime(),fSetCookie("starttime",a,!1))}function fEnData(a){var b,c,d,e,f,g,h;return window.RSAKey?null==a||0==a.length?(alert("参数非法"),!1):(b=new Array,b=a.split("\n"),c=b[0],"401"==c?alert("参数非法"):"500"==c?alert("服务端异常"):"200"==c&&(d=b[1],e=b[2],f=$id("pwdInput").value,g=new RSAKey,g.setPublic(e,d),h=g.encrypt(MD5(f)),window.location.href="http://reg.163.com/httpLoginVerifyNew.jsp?"+fUrlP("product",gOption.product,!0)+fUrlP("rcode",h)+fUrlP("savelogin",$id("savelogin").value)+fUrlP("url",encodeURIComponent(window.sHttpAction))+fUrlP("url2",encodeURIComponent(gOption.url2))+fUrlP("username",$id("idInput").value+"@"+gOption.sDomain)),void 0):(window.bGettingAlgorithm||(fGetScript("http://mimg.127.net/index/lib/scripts/algorithm.js"),window.bGettingAlgorithm=!0),setTimeout(function(){fEnData(a)},200),void 0)}function loginRequest(a){var b=getRnd($id("idInput").value+"@"+gOption.sDomain);c_url="http://reg.163.com/services/httpLoginExchgKeyNew?rnd="+b,c_url+="&jsonp="+a,fGetScript(c_url)}function getRnd(a){var b=base64encode(utf16to8(a));return b}function base64encode(a){for(var e,f,g,d=a.length,c=0,b="";d>c;){if(e=255&a.charCodeAt(c++),c==d){b+=base64EncodeChars.charAt(e>>2),b+=base64EncodeChars.charAt((3&e)<<4),b+="==";break}if(f=a.charCodeAt(c++),c==d){b+=base64EncodeChars.charAt(e>>2),b+=base64EncodeChars.charAt((3&e)<<4|(240&f)>>4),b+=base64EncodeChars.charAt((15&f)<<2),b+="=";break}g=a.charCodeAt(c++),b+=base64EncodeChars.charAt(e>>2),b+=base64EncodeChars.charAt((3&e)<<4|(240&f)>>4),b+=base64EncodeChars.charAt((15&f)<<2|(192&g)>>6),b+=base64EncodeChars.charAt(63&g)}return b}function utf16to8(a){var b,c,d,e;for(b="",d=a.length,c=0;d>c;c++)e=a.charCodeAt(c),e>=1&&127>=e?b+=a.charAt(c):e>2047?(b+=String.fromCharCode(224|15&e>>12),b+=String.fromCharCode(128|63&e>>6),b+=String.fromCharCode(128|63&e>>0)):(b+=String.fromCharCode(192|31&e>>6),b+=String.fromCharCode(128|63&e>>0));return b}function fGetLocator(a){var b,c,d,e,f;try{if(b=a.split("&"),window.gLocationProvince="common",window.gLocationCity="common",b.length>0)for(c=0;c<b.length;c++)if(d=b[c].split("="),2==d.length)switch(e=d[0],f=d[1],e){case"province":window.gLocationProvince=f;break;case"city":window.gLocationCity=f}window.fSetLocation&&fSetLocation(a)}catch(g){}}var gbForcepc,gUserInfo,gVisitorCookie,gMobileNumMailIsForbidden,gMobileNumMailResult,gMobileNumMail,DOMContentLoaded,DOMREADY,base64EncodeChars,oAndroidRedirect={sPhoneUrl:"",sPadUrl:""};Object.extend=function(a,b,c){a=a||{},b=b||{};for(var d in b)if("prototype"!==d)try{(!c||this.has&&!this.has(a,d))&&(a[d]=b[d])}catch(e){}try{c||b.toString===b.constructor.prototype.toString||(a.toString=b.toString)}catch(e){}return a},function(a){a.CapsLock=function(a){function c(a){var b=this,c=b.el=a.el,d={keypress:function(a){b._keyPress(a)},keydown:function(a){b._keyDown(a)},blur:function(a){b._blur(a)}};b.capsLockInfo=d,b.change=a.change,fEventListen(c,"keypress",d.keypress),fEventListen(c,"keydown",d.keydown),fEventListen(c,"blur",d.blur)}function d(){var a=this;return a.status}function e(){var a=this;a.change&&a.change(a.status)}function f(a){var b=this,c=a.which||a.keyCode;20===c&&void 0!==b.status&&(b.preStatus=b.status=!b.status,b.trigger(b.status))}function g(a){var e,b=this,c=a.which||a.keyCode,d=!1;a.shiftKey?d=!0:a.modifiers&&(d=!!(4&a.modifiers)),e=b.preStatus,b.preStatus=b.status,b.status=c>=65&&90>=c&&!d||c>=97&&122>c&&d?!0:c>=65&&90>=c&&d||c>=97&&122>c&&!d?!1:e,b.status!==b.preStatus&&b.trigger(b.status)}function h(){var a=this;a.preStatus=a.status=void 0,a.trigger(a.status)}var b={preStatus:void 0,status:void 0,initialize:c,isOn:d,trigger:e,_keyDown:f,_keyPress:g,_blur:h};Object.extend(CapsLock.prototype,b),Object.extend(CapsLock.prototype,a),this.initialize(a)}}(window),gUserInfo={username:null,style:null,safe:null},gVisitorCookie=function(){var a=function(){var b,a=fGetCookie("nts_mail_user");void 0!=a&&(b=a.split(":"),3==b.length&&(gUserInfo["username"]=b[0],gUserInfo["style"]=b[1],gUserInfo["safe"]=b[2]))},b=function(){var a=gUserInfo.username+":"+gUserInfo.style+":"+gUserInfo.safe;c("nts_mail_user",a,!0)},c=function(a,b,c,d){var e=";domain="+(d||gOption["sCookieDomain"]);document.cookie=a+"="+b+e+(c?";expires="+new Date(2099,12,31).toGMTString():"")};return{init:function(){return a(),this},saveInfo:function(){b()},loadInfo:function(){a()}}}().init(),gMobileNumMail=function(){var c,d,f,g,h,a="http://mbind.mail.126.com/mbind/qn.do?uid=",b="http://mbind.mail.126.com/mbind/qu.do?pn=",e={},i=["xxxxx","xxx"],j=Math.round((new Date).getTime()/864e5)+"",k=function(){var a=fGetCookie("MTip");return 1==a?!0:!1},l=function(){fSetCookie("MTip","1",!0),$id("mobtips").style.display="none"},m=function(a){var b,d;return b=a+"@"+gOption["sDomain"],d=r(a,b),-1===d?(MobCallback({nCode:"private",sNum:"invalidMail"}),void 0):0===d?(void 0===g?MobCallback({nCode:"404"}):MobCallback({nCode:"200",sNum:g}),void 0):(c=b,e["all"]=fGetCookie("P_INFO"),e["all"]&&e["all"].length>0&&(e["uid"]=e["all"].split("|")[0],e["num"]=e["all"].split("|")[6]),e.uid&&e.uid!==b?(p(b),void 0):e.num&&e.num.indexOf("&")>-1?(f=e.num.split("&")[0],""==f?MobCallback({nCode:"404"}):MobCallback({nCode:"200",sNum:f}),void 0):(p(b),void 0))},n=function(a){var b="",c=a;return 6===c.length&&(b=c.substr(0,3)+i[0]+c.substr(3,3)),8===c.length&&(b=c.substr(0,4)+i[1]+c.substr(4,4)),b},o=function(a){var b=fTrim(a);return b==d?(void 0==h?MobCallback({nCode:"404"}):MobCallback({nCode:"200",sNum:h}),void 0):fParseMNum(b)?(d=b,q(b),void 0):(MobCallback({nCode:"private",sNum:"invalidNum"}),void 0)},p=function(b){fGetScript(a+b+"&t="+j)},q=function(a){fGetScript(b+a+"&t="+j)},r=function(a,b){var d=/^[a-zA-Z0-9_\.-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;return!d.test(b)||fParseMNum(a)?-1:"string"==typeof c&&c===b?0:1};return window.MobCallback=function(a){var b,c,j,k,e=$id("mobtips"),f=$id("mobtips_txt");$id("mobtips_close");try{j=a,"private"==j.nCode&&(gMobileNumMailResult=j.sNum,("invalidMail"==gMobileNumMailResult||"invalidNum"==gMobileNumMailResult)&&(e.style.display="none")),200==j.nCode&&(j.sNum&&j.sNum.length>8?(h=j.sNum,gMobileNumMailResult=h,c=gMobileNumMailResult.split("@")[1],c!=gOption.sDomain?(k=d+"@"+c,e.style.height="auto",b="此手机号码的邮箱是<br/><em>"+k+'</em>，<a style="text-decoration:none;" href="http://email.163.com/index.htm#uid='+k+'">点此登录</a>'):b="此号码已与帐号：<em>"+gMobileNumMailResult+"</em> 绑定"):(g=j.sNum,gMobileNumMailResult=n(g),b="用你的手机号 <em>"+gMobileNumMailResult+"</em> 也可登录"),f.innerHTML=b,e.style.display="block"),404==j.nCode&&(1==ntabOn?(b='手机号码也可登录，<a href="http://e.mail.163.com/mobilemail/home.do?from=mail163">免费激活</a>',g=void 0):(b="此号码还未手机号登录",h=void 0),f.innerHTML=b,e.style.display="block")}catch(l){e.style.display="none"}},{init:function(){return this},forbidden:function(){return(gMobileNumMailIsForbidden=k())?!1:(l(),void 0)},getNumFromMail:function(a){return(gMobileNumMailIsForbidden=k())?!1:(m(a),void 0)},getMailFromNum:function(a){return(gMobileNumMailIsForbidden=k())?!1:(o(a),void 0)}}}().init(),window.bGettingAlgorithm=!1,DOMREADY=function(a){function c(){if(!b.isReady){try{document.documentElement.doScroll("left")}catch(a){return setTimeout(c,1),void 0}b.isReady=!0,b.ready()}}var b={isReady:!1,ready:a,bindReady:function(){try{if("complete"===document.readyState)return b.isReady=!0,setTimeout(b.ready,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",DOMContentLoaded,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);var a=!1;try{a=null==window.frameElement}catch(d){}document.documentElement.doScroll&&a&&c()}}catch(d){}}};document.addEventListener?DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,!1),b.ready()}:document.attachEvent&&(DOMContentLoaded=function(){if("complete"===document.readyState){if(document.detachEvent("onreadystatechange",DOMContentLoaded),b.isReady)return;b.isReady=!0,b.ready()}}),b.bindReady()},base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",function(a){function b(){var a=this;a.initData(),a.initParam(),a.initInterface(),a.getData()}function c(){var c,d,a=this,b="";if(a._curDomain="email.163.com",gOption.sCookieDomain!=a._curDomain&&(a._curDomain=gOption.sDomain),a._dftAD.length>0){for(c=0,d=a._dftAD.length;d>c;c++)a._dftAD[c].index=a._dftAD[c].pid;b=a.outputHtml(a._dftAD)}a._data={domain:{"163.com":!0,"126.com":!0,"yeah.net":!0,"email.163.com":!0},html:b},setTimeout(function(){if(!a._bSuc){var b=$id("extText");b.innerHTML=a._data.html}},3e3)}function d(){var d,a=this,b=a._param,c="";"email.163.com"==a._curDomain?(d=fGetCookie("alllogindomain"),c="163"==d?"163.com":"126"==d?"126.com":"yeah"==d?"yeah.net":"email.163.com",b.uid=gLoginInfo[d]?(gLoginInfo[d].username?gLoginInfo[d].username:"nt")+"@"+c:"nt@"+a._curDomain):b.uid=(gUserInfo.username?gUserInfo.username:"nt")+"@"+a._curDomain,b.domain=a._curDomain,b.ver=a._ver,b.ph=-1,b.callback="loginExtAD.callback"}function e(){var a=this,b="http://ir.mail.163.com/get.do";try{("163.com"==a._curDomain||"email.163.com"==a._curDomain)&&(b="http://ir.mail.163.com/get.do"),"126.com"==a._curDomain&&(b="http://ir.mail.126.com/get.do"),"yeah.net"==a._curDomain&&(b="http://ir.mail.yeah.net/get.do")}catch(c){}a._interface=b}function f(){var c,d,b=this;return b.isOpen?(b._param.uid=a.themeHandler._param.uid,c=b._param,d=b._interface,b._data.domain[b._curDomain]?fJSONP(d,c):b.callback(),void 0):(b.callback(),void 0)}function g(a){var b=this,c=b._data,d=[];a.lt[1].promText='<span style="color:#e60d40;">拒绝裸奔 网易邮箱支持多种登录二次验证</span>',a.lt[1].promTextClickCountUrl="http://tech.163.com/16/1119/20/C68TBHQ100097U7R.html?from=webmail",void 0==a.templateUrl||fGetScript(a.templateUrl,function(){var e,f,g,i;if(a&&a.lt)try{if(void 0!=typeof gAdTemplate&&gAdTemplate.parse){for(b._bSuc=!0,d=a.lt,e=d.length-1;e>0;--e)for(f=0;e>f;++f)d[f].pid>d[f+1].pid&&(g=d[f],d[f]=d[f+1],d[f+1]=g);a.lt=d,c.html=b.outputHtml(gAdTemplate.parse(a).lt)}}catch(h){}i=$id("extText"),i.innerHTML=c.html,"yeah.net"==b._curDomain&&indexLogin.shadowFix(!0)})}function h(a){var e,f,g,b=this,c="",d=b._adNum[b._curDomain];if(b._bSuc){for(e=0,f=a.length;f>e;e++)a[e].index=e+1;if(a.length<d){for(g=0;d>g;g++)b._dftAD[g].index=a.length+g+1;a=a.concat(b._dftAD)}}for(e=0;d>e;e++)c+=b.template(b._tpl[b._curDomain],a[e]);return c}function i(a,b){var c=/#\{([^\{\}]*?)\}/g;return a.replace(c,function(a,c){return void 0==typeof b[c]?"":b[c]})}a.loginExtAD={isOpen:!0,init:b,initData:c,initParam:d,initInterface:e,getData:f,callback:g,template:i,outputHtml:h,_data:{},_dftData:{},_curDomain:"",_interface:"",_param:{},_ver:4,_tpl:{"163.com":'<li class="ext-#{index}">#{div}</li>',"126.com":'<li class="ext-#{index}">#{div}</li>',"yeah.net":"#{div}","email.163.com":'<li class="ext-#{index}"><span>·</span>#{div}</li>'},_adNum:{"163.com":2,"126.com":2,"yeah.net":1,"email.163.com":3},_dftAD:[{pid:1,div:'<a href="http://you.163.com/?from=web_rk_mail_rc_0" target="_blank" style="">网易自营生活电商30天无忧退货</a>'},{pid:2,div:'<a href="http://you.163.com/manufacturer/list?from=web_rk_mail_rc_0" target="_blank" style="">一线品牌制造商直供好物2折起</a>'},{pid:3,div:'<a href="http://mail.163.com/html/ntesmail5/" target="_blank" style="">网易邮箱5.0版介绍</a>'}],_bSuc:!1}}(window);